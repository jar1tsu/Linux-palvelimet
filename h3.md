## x Lue ja tiivistä
The Apache Software Foundation 2023: Apache HTTP Server Version 2.4 Documentation:

### IP‑pohjainen virtualisointi
- Valinta tehdään IP‑osoitteen ja portin perusteella
- Jokainen sivusto tarvitsee oman IP‑osoitteen
- Käyttö nykyään harvinaista, ellei jokin laitteisto tai sovellus sitä nimenomaan vaadi

### Nimi‑pohjainen virtualisointi (Name‑based)
- Useita verkkotunnuksia voidaan palvella yhdellä IP‑osoitteella
- Valinta tehdään HTTP‑pyynnön Host‑headerin perusteella
- Helppo ottaa käyttöön: riittää, että DNS osoittaa kaikki domainit samaan IP:hen
- Säästää IP‑osoitteita ja on nykyisin suositeltu tapa melkein kaikissa ympäristöissä

### Miten Apache valitsee oikean VirtualHostin
1.IP + portti arvioidaan ensin
– Apache etsii ensin ne VirtualHost‑kohdat, jotka vastaavat pyynnön IP‑osoitetta ja porttia
– Jos käytetään *:80, kaikki kyseisen portin VHostit ovat samassa ryhmässä

2.ServerName ja ServerAlias ratkaisevat lopullisen valinnan
– Apache vertaa pyynnön Host‑arvoa ServerName/ServerAlias‑kenttiin
– Ensimmäinen täsmäävä VHost valitaan

3.Oletus‑VHost
– Jos nimi ei täsmää mihinkään, ensimmäinen kyseisen IP+portin VHostista toimii oletuksena.
– Siksi on hyvä määrittää tarkoituksellinen oletus‑VHost.

### ServerName ja ServerAlias
- Suositeltavaa määrittää ServerName aina, muuten Apache arvaa nimen, joka voi johtaa yllättäviin tuloksiin
- ServerAliasilla lisätään vaihtoehtoisia nimiä, esim.:
ServerAlias example.com *.example.com
- DNS:n tulee osoittaa kaikki aliakset samaan IP‑osoitteeseen, jotta ne toimivat

### VirtualHost‑lohkojen käyttö

- Jokaiselle sivustolle yksi <VirtualHost>‑lohko.

#### Vähintään tarvitaan:
  - ServerName = sivuston ensisijainen nimi
  - DocumentRoot = sivuston sisältökansio

- Muut asetukset voidaan lisätä lohkon sisään ja ne koskevat vain kyseistä sivustoa
- Pääkonfiguraation asetukset toimivat vain, ellei VHost yliaja niitä

Lähde: Apache. 2023. Name-based Virtual Host Support. Luettavissa: https://httpd.apache.org/docs/2.4/vhosts/name-based.html. Luettu: 1.2.2026.

Name Based Virtual Hosts on Apache - Multiple Websites to Single IP Address

- Apache mahdollistaa useiden sivustojen ajamisen yhdellä IP‑osoitteella käyttäen name‑based virtual hosteja
- Jokaiselle sivustolle tehdään oma konfiguraatiotiedosto hakemistoon
/etc/apache2/sites-available/<domain>.conf

#### Perusasetukset VirtualHostissa:
- ServerName = domain
- ServerAlias = vaihtoehtoinen nimi (esim. www)
- DocumentRoot = sivuston kansio
- Require all granted sallii sivuston näyttämisen


- Sivusto otetaan käyttöön komennolla a2ensite ja Apache restartataan
- Sivuston sisältö voidaan luoda tavallisella käyttäjällä omassa hakemistossa
- Ilman oikeaa DNS:ää testaus voidaan tehdä curlilla tai lisäämällä nimi hosts‑tiedostoon
- Jos eri domainit näyttävät eri sivut, name‑based virtual hosting toimii





